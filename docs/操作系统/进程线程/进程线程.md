多进程中占用内存多，切换复杂，CPU利用率低；多线程中占用内存少，切换简单，CPU利用率高；

多进程中编程简单，调试简单；多线程编程复杂，调试复杂。

多进程进程间不会相互影响；多线程一个线程挂掉将导致整个进程挂掉。



### 线程和进程有什么区别？

进程（process）是操作系统为正在运行的程序提供的抽象。

线程（thread）是操作系统能够进行运算调度的最小单位。被包含在进程中，是进程的实际运作单位。

有了线程技术，我们就可以在一个进程中创建多个线程，让它们在**“同一时刻”**分别去做不同的工作了。这些线程共享同一块内存，线程之间可以共享对象、资源，如果有冲突或需要协同，还可以随时沟通以解决冲突或保持同步。

<font color='red'>**缺点：**</font>在一个进程内，不管你创建了多少线程，它们总是被限定在一颗CPU内，或者多核CPU的一个核内。这意味着，多线程在宏观上是并行的，在微观上则是分时切换串行的，多线程编程无法充分发挥多核计算资源的优势。这也是使用多线程做任务并行处理时，线程数量超过一定数值后，线程越多速度反倒越慢的原因。

多进程技术正好弥补了多线程编程的不足，我们可以在每一颗CPU上，或者多核CPU的每一个核上启动一个进程，如果有必要，还可以在每个进程内再创建适量的线程，最大限度地使用计算资源解决问题。因为不在同一块内存区域内，和线程相比，进程间的资源共享、通信、同步等，都要麻烦得多，受到的限制也更多。



| 维度           | 多进程                                                       | 多线程                                 | 总结     |
| :------------- | ------------------------------------------------------------ | -------------------------------------- | -------- |
| 数据共享、同步 | 数据是分开的：共享复杂，需要用IPC；同步简单                  | 多线程共享进程数据：共享简单；同步复杂 | 各有优势 |
| 内存、CPU      | 占用内存多，切换复杂，CPU利用率低                            | 占用内存少，切换简单，CPU利用率高      | 线程优势 |
| 创建销毁、切换 | 创建、销毁、切换复杂，速度慢                                 | 创建、销毁、切换简单，速度快           | 线程优势 |
| 编程调试       | 编程简单、调试简单                                           | 编程复杂，调试复杂                     | 进程优势 |
| 可靠性         | 进程间不会相互影响                                           | 一个线程挂掉，整个进程挂掉             | 进程优势 |
| 分布式         | 适应于多核、多机分布；如果一台机器不够，扩展到多台机器比较简单 | 适应于多核分布                         | 进程优势 |



### 什么时候用进程、线程？

1．耗时的操作使用线程，提高应用程序响应。

2．并行操作时使用线程，如C/S架构的服务器端并发线程响应用户的请求。 

3．多CPU系统中，使用线程提高CPU利用率 

4．改善程序结构。一个既长又复杂的进程可以考虑分为多个线程，成为几个独立或半独立的运行部分，这样的程序会利于理解和修改。



**进程与线程的选择取决以下几点：**

1、需要频繁创建销毁的优先使用线程；因为对进程来说创建和销毁一个进程代价是很大的。

2、线程的切换速度快，所以在需要大量计算，切换频繁时用线程，还有耗时的操作使用线程可提高应用程序的响应

3、因为对CPU系统的效率使用上线程更占优，所以可能要发展到多机分布的用进程，多核分布用线程；

4、并行操作时使用线程，如C/S架构的服务器端并发线程响应用户的请求；

5、需要更稳定安全时，适合选择进程；需要速度时，选择线程更好。

不论什么时候只要能用单线程就不用多线程，只有在需要响应时间要求比较高的情况下用多线程。某操作允许并发而且该操作有可能阻塞时,用多线程。



**C/C++中如何使用多线程编程？**

```c++
pthread_create               创建一个新线程
pthread_exit                 结束调用的线程
pthread_join                 等待一个特定的线程退出
pthread_yield                释放CPU来运行另外一个线程
pthread_attr_init            创建并初始化一个线程的属性结构
pthread_attr_destroy         删除一个线程的属性结构
```



### Reference

https://www.zhihu.com/question/25532384

